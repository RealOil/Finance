# 작업 1.5: 소득 및 지출 계산 로직 구현

## 작업 정보

- **작업 ID**: 05_calculations_income
- **우선순위**: 높음 (필수)
- **예상 시간**: 2일
- **계획 작성 시간**: 2025-12-21 23:12:00
- **구현 시작 시간**: 2025-12-21 23:20:13
- **구현 완료 시간**: 2025-12-21 23:20:35
- **테스트 완료 시간**: 2025-12-21 23:21:30

---

## 작업 목표

소득 및 지출 기반 계산 로직을 구현합니다.
10년 후 예상 자산 추정, 재정 건전성 등급 평가, 월 저축 가능액 계산 등을 수행합니다.

---

## 작업 내용

### 1. 미래 자산 추정 함수

**함수**: `calculate_future_assets(inputs: Dict[str, Any], years: int = 10) -> Dict[str, Any]`

**기능**:
- 현재 자산과 소득, 지출을 기반으로 N년 후 예상 자산 계산
- 연봉 증가율 반영
- 인플레이션 반영 (기본값: 2.5%)
- 연간 순 저축액 계산

**계산 로직**:
```
연간 소득 = 연봉 + 보너스
연간 지출 = (월 지출 × 12) + 연간 고정 지출
연간 순 저축액 = 연간 소득 - 연간 지출

매년:
  - 연봉 = 이전 연봉 × (1 + 연봉 증가율 / 100)
  - 연간 소득 = 연봉 + 보너스
  - 연간 지출 = (월 지출 × 12) × (1 + 인플레이션 / 100) + 연간 고정 지출
  - 연간 순 저축액 = 연간 소득 - 연간 지출
  - 자산 = 이전 자산 + 연간 순 저축액
```

**반환값**:
```python
{
    'current_assets': float,
    'future_assets': float,
    'total_savings': float,
    'yearly_breakdown': List[Dict],  # 연도별 상세 내역
    'years': int
}
```

### 2. 재정 건전성 등급 평가 함수

**함수**: `calculate_financial_health_grade(inputs: Dict[str, Any]) -> Dict[str, Any]`

**기능**:
- 소득 대비 지출 비율 계산
- 자산 대비 부채 비율 계산
- 월 저축 가능액 계산
- 비상금 기준 충족 여부 확인
- 종합 등급 산출 (A+, A, B, C, D)

**등급 기준** (docs/data_sources.md 참조):
- A+: 소득 대비 지출 < 50%, 비상금 6개월 이상, 부채 없음
- A: 소득 대비 지출 < 60%, 비상금 3개월 이상, 부채 비율 < 20%
- B: 소득 대비 지출 < 70%, 비상금 1개월 이상, 부채 비율 < 40%
- C: 소득 대비 지출 < 80%, 부채 비율 < 60%
- D: 그 외

**반환값**:
```python
{
    'grade': str,  # 'A+', 'A', 'B', 'C', 'D'
    'expense_ratio': float,  # 소득 대비 지출 비율
    'debt_ratio': float,  # 자산 대비 부채 비율
    'monthly_savings': float,  # 월 저축 가능액
    'emergency_fund_months': float,  # 비상금 지속 가능 개월
    'details': Dict  # 상세 정보
}
```

### 3. 월 저축 가능액 계산 함수

**함수**: `calculate_monthly_savings(inputs: Dict[str, Any]) -> float`

**기능**:
- 연간 소득과 지출을 기반으로 월 저축 가능액 계산

**계산 로직**:
```
월 소득 = (연봉 + 보너스) / 12
월 지출 = 월 지출 + (연간 고정 지출 / 12)
월 저축 가능액 = 월 소득 - 월 지출
```

### 4. 인플레이션 적용 함수

**함수**: `apply_inflation(value: float, years: int, inflation_rate: float = 2.5) -> float`

**기능**:
- 인플레이션을 반영한 미래 가치 계산

**계산 로직**:
```
미래 가치 = 현재 가치 × (1 + 인플레이션 / 100) ^ 연수
```

---

## 구현 체크리스트

- [x] `modules/calculations.py` 파일 생성 (2025-12-21 23:20:13)
- [x] `calculate_future_assets()` 함수 구현 (2025-12-21 23:20:35)
- [x] `calculate_financial_health_grade()` 함수 구현
- [x] `calculate_monthly_savings()` 함수 구현
- [x] `apply_inflation()` 함수 구현
- [x] 타입 힌트 추가
- [x] docstring 작성

---

## 테스트 계획

### 테스트 항목

1. **미래 자산 추정 테스트**
   - 기본 시나리오 계산
   - 연봉 증가율 반영 확인
   - 인플레이션 반영 확인
   - 연도별 상세 내역 확인

2. **재정 건전성 등급 테스트**
   - 각 등급별 시나리오 테스트
   - 경계값 테스트
   - 등급 산출 로직 확인

3. **월 저축 가능액 계산 테스트**
   - 정상 케이스
   - 지출이 소득보다 큰 경우

4. **인플레이션 적용 테스트**
   - 기본 인플레이션율 적용
   - 커스텀 인플레이션율 적용

---

## 데이터 출처

- 인플레이션율: 2.5% (docs/data_sources.md)
- 재정 건전성 등급 기준: docs/data_sources.md 참조
- 비상금 기준: 월 지출의 3~6개월분

---

## 예상 결과

- 소득 및 지출 계산 로직이 완성됨
- 미래 자산 추정 가능
- 재정 건전성 등급 평가 가능
- 다음 작업(리스크 계산 로직)을 시작할 수 있는 상태

---

## 다음 작업

작업 1.6: 리스크 계산 로직 구현

